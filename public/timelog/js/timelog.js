(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+OGC":function(t,s){},0:function(t,s,e){e("pLur"),t.exports=e("+OGC")},"1mfx":function(t,s,e){"use strict";var i=e("skN/");e.n(i).a},"9U42":function(t,s,e){(t.exports=e("I1BE")(!1)).push([t.i,"\na[data-v-1f15ecb2] {\n    text-decoration: none;\n}\n",""])},FG8O:function(t,s,e){var i=e("9U42");"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};e("aET+")(i,n);i.locals&&(t.exports=i.locals)},f9tg:function(t,s,e){"use strict";var i=e("FG8O");e.n(i).a},jjq8:function(t,s,e){(t.exports=e("I1BE")(!1)).push([t.i,"\n.btn.disabled[data-v-5df658fc], .btn[data-v-5df658fc]:disabled {\n    opacity: 0.30;\n}\n",""])},pLur:function(t,s,e){"use strict";e.r(s);var i=e("XuX8"),n=e.n(i),a=e("IuxL"),r=e.n(a),o=e("qSUR"),c={name:"UserCards",data:function(){return{users:[]}},mounted:function(){this.loadUsers()},methods:{loadUsers:function(){var t=this;axios.get("/zvs/users").then(function(s){return t.users=s.data})},openPinModal:function(t){this.$root.$emit("bv::show::modal","modal-pin"),this.$emit("userCardClick",t)},getCardClass:function(t){return 10===t.type||21===t.type||31===t.type?"bg-success text-white":11===t.type?"bg-secondary text-white":20===t.type?"bg-info text-white":30===t.type?"bg-warning text-white":void 0}}},l=(e("f9tg"),e("KHd+")),d={components:{appUserCards:Object(l.a)(c,function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"row mt-1"},t._l(t.users,function(s){return e("div",{staticClass:"col-sm-4"},[e("a",{staticClass:"card mt-2 mb-2",class:t.getCardClass(s),attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openPinModal(s)}}},[e("div",{staticClass:"card-body"},[e("h2",{staticClass:"card-title"},[t._v(t._s(s.firstname)+" "+t._s(s.lastname.charAt(0))+".")])])])])}),0)},[],!1,null,"1f15ecb2",null).exports},data:function(){return{disabledTypes:new Map([[10,[21,31]],[11,[20,21,30,31]],[20,[10,11,30,31]],[21,[10,31]],[30,[10,11,20,21]],[31,[10,21]]]),pin:"",type:11,name:"",validationError:"",currentUser:{firstname:"",lastname:"",email:"",type:11},types:[{id:10,name:"Start work"},{id:11,name:"End work"},{id:20,name:"Start break"},{id:21,name:"End break"},{id:30,name:"Start home visit"},{id:31,name:"End home visit"}],errors:[],startText:this.$t("Start")}},mounted:function(){var t=this;this.$root.$on("bv::modal::shown",function(s,e){t.$refs.pin.focus()})},methods:{setActive:function(t){this.isDisabled(t)||(this.type=t)},isDisabled:function(t){return this.currentUser.type===t||-1!==this.userDisabledTypes.indexOf(t)},handleCardClick:function(t){this.currentUser=t,10===t.type?this.type=20:11===t.type?this.type=10:20===t.type?this.type=21:21===t.type?this.type=11:30===t.type?this.type=31:31===t.type&&(this.type=11);var s=new Date;t.booking_time&&11===t.type&&s.toISOString().split("T")[0]===t.booking_time.substr(0,10)?this.startText=this.$t("Restart"):this.startText=this.$t("Start")},verifyUserPin:function(t){var s=this;t.preventDefault(),axios.post("/zvs/track",{pin:this.pin,email:this.currentUser.email,type:this.type}).then(function(t){s.$bvModal.hide("modal-pin"),s.$refs.usercards.loadUsers();try{s.$socket.emit("timelog")}catch(t){console.log("Could not emit event.")}}).catch(function(t){s.errors=t.response.data.errors,401==t.response.status&&(s.validationError=!0,s.pin="",s.$refs.pin.focus()),400==t.response.status&&(s.pin="",s.$bvModal.hide("modal-pin"),s.$refs.usercards.loadUsers())})},resetModal:function(){this.validationError="",this.pin="",this.errors=[]}},computed:{userDisabledTypes:function(){return this.currentUser.type?this.disabledTypes.get(this.currentUser.type):this.disabledTypes.get(11)}},sockets:{connect:function(){console.log("Socket connected")},update:function(t){this.$refs.usercards.loadUsers()}}},u=(e("1mfx"),Object(l.a)(d,function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"container"},[e("app-user-cards",{ref:"usercards",on:{userCardClick:function(s){return t.handleCardClick(s)}}}),t._v(" "),e("b-modal",{staticStyle:{display:"none"},attrs:{id:"modal-pin",size:"md","hide-footer":""},on:{ok:t.verifyUserPin,cancel:t.resetModal,hide:t.resetModal}},[e("template",{slot:"modal-title"},[t._v("\n            "+t._s(t.currentUser.firstname)+" "+t._s(t.currentUser.lastname.charAt(0))+".\n        ")]),t._v(" "),e("form",{ref:"form",on:{submit:function(s){return s.stopPropagation(),s.preventDefault(),t.verifyUserPin(s)}}},[e("div",{staticClass:"row mb-3"},[e("div",{staticClass:"col-4"},[e("div",[t._v("\n                        "+t._s(t.$t("Present"))+"\n                    ")]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 pr-1"},[e("button",{staticClass:"btn btn-block",class:{active:10===t.type,"btn-outline-secondary":t.isDisabled(10),"btn-outline-success":!t.isDisabled(10)},attrs:{type:"button",disabled:t.isDisabled(10)},on:{click:function(s){return t.setActive(10)}}},[t._v(t._s(t.startText))])]),t._v(" "),e("div",{staticClass:"col-6 pl-1"},[e("button",{staticClass:"btn btn-block",class:{active:11===t.type,"btn-outline-secondary":t.isDisabled(11),"btn-outline-secondary":!t.isDisabled(11)},attrs:{type:"button",disabled:t.isDisabled(11)},on:{click:function(s){return t.setActive(11)}}},[t._v(t._s(t.$t("End")))])])])]),t._v(" "),e("div",{staticClass:"col-4"},[e("div",[t._v("\n                        "+t._s(t.$t("Break"))+"\n                    ")]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 pr-1"},[e("button",{staticClass:"btn btn-block",class:{active:20===t.type,"btn-outline-secondary":t.isDisabled(20),"btn-outline-info":!t.isDisabled(20)},attrs:{type:"button",disabled:t.isDisabled(20)},on:{click:function(s){return t.setActive(20)}}},[t._v(t._s(t.$t("Start")))])]),t._v(" "),e("div",{staticClass:"col-6 pl-1"},[e("button",{staticClass:"btn btn-block",class:{active:21===t.type,"btn-outline-secondary":t.isDisabled(21),"btn-outline-success":!t.isDisabled(21)},attrs:{type:"button",disabled:t.isDisabled(21)},on:{click:function(s){return t.setActive(21)}}},[t._v(t._s(t.$t("End")))])])])]),t._v(" "),e("div",{staticClass:"col-4"},[e("div",[t._v("\n                        "+t._s(t.$t("Home visitation"))+"\n                    ")]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 pr-1"},[e("button",{staticClass:"btn btn-block",class:{active:30===t.type,"btn-outline-secondary":t.isDisabled(30),"btn-outline-warning":!t.isDisabled(30)},attrs:{type:"button",disabled:t.isDisabled(30)},on:{click:function(s){return t.setActive(30)}}},[t._v(t._s(t.$t("Start")))])]),t._v(" "),e("div",{staticClass:"col-6 pl-1"},[e("button",{staticClass:"btn btn-block",class:{active:31===t.type,"btn-outline-secondary":t.isDisabled(31),"btn-outline-success":!t.isDisabled(31)},attrs:{type:"button",disabled:t.isDisabled(31)},on:{click:function(s){return t.setActive(31)}}},[t._v(t._s(t.$t("End")))])])])])]),t._v(" "),e("div",{staticClass:"row mb-3"},[e("div",{staticClass:"col-4 offset-8"},[e("div",[t._v("\n                        Computer\n                    ")]),t._v(" "),e("button",{staticClass:"btn btn-primary btn-block",attrs:{type:"button"}},[t._v(t._s(t.$t("Turn on")))])])]),t._v(" "),e("div",{staticClass:"row mb-4"},[e("div",{staticClass:"col"},[e("div",{staticClass:"border p-2",staticStyle:{"min-height":"100px"}},[t._v("\n                        Hinweistext...\n                    ")])])]),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"row form-inline",staticStyle:{"align-items":"normal"}},[e("div",{staticClass:"col-5 offset-4 pr-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.pin,expression:"pin"}],ref:"pin",staticClass:"form-control",class:{"is-invalid":t.validationError},staticStyle:{width:"inherit"},attrs:{type:"number",id:"tlogInputPin",placeholder:"1234",autocomplete:"pleaseno",required:"",minlength:"4",maxlength:"4",autofocus:""},domProps:{value:t.pin},on:{keydown:function(s){t.validationError=""},input:function(s){s.target.composing||(t.pin=s.target.value)}}}),t._v(" "),t.validationError?e("div",{staticClass:"invalid-feedback"},[t._v("\n                        "+t._s(t.$t("Incorect PIN."))+"\n                    ")]):t._e()]),t._v(" "),e("div",{staticClass:"col-3 pl-1"},[e("button",{staticClass:"btn btn-primary btn-block",attrs:{type:"button"},on:{click:t.verifyUserPin}},[t._v(t._s(t.$t("OK")))])])]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},t._l(t.errors,function(s){return e("div",{staticClass:"alert alert-danger mt-2",attrs:{role:"alert"}},[t._v("\n                        "+t._s(s[0])+"\n                    ")])}),0)])])],2)],1)},[],!1,null,"5df658fc",null).exports),v=e("275+"),p=e("UTJ8"),b=e.n(p);window.Locale="de",window.Vue=n.a,n.a.use(v.a),n.a.use(o.a),window.axios=e("vDqi");var f=JSON.parse(document.getElementById("config").innerHTML);f.hasOwnProperty("SOCKETIO_SOCKET")&&f.SOCKETIO_SOCKET&&n.a.use(new b.a({debug:!1,connection:f.SOCKETIO_SOCKET}));var m=new o.a({locale:window.Locale,messages:r.a});new n.a({el:"#app",render:function(t){return t(u)},i18n:m})},"skN/":function(t,s,e){var i=e("jjq8");"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};e("aET+")(i,n);i.locals&&(t.exports=i.locals)}},[[0,0,2]]]);